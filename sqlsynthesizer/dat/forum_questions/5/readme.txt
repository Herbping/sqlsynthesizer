see the four_tables example

http://forums.databasejournal.com/showthread.php?52415-hard-query